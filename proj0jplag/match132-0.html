<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>sub_674278</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>NBody.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A><FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match132-1.html#0',3,'match132-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>public class NBody
{
	public static void main(String args[])
	{
		double T = Double.parseDouble(args[0]);
		double dt = Double.parseDouble(args[1]);
		String filename = args[2];
<A NAME="1"></A>		double radius = readRadius(filename);
		Planet[] parray = readPlanets(filename);</B></FONT>

<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match132-1.html#1',3,'match132-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>		StdDraw.setScale(-radius,radius);
		StdDraw.picture(0,0,&quot;./images/starfield.jpg&quot;);

		for(Planet p : parray)
		{
			p.draw();
		}

		double time = 0;

		while(time &lt; T)
		{	
			double[] xForces = new double[parray.length];
			double[] yForces = new double[parray.length];

			for(int i = 0; i &lt; parray.length; i++)
			{
				xForces[i] = parray[i].calcNetForceExertedByX(parray);
				yForces[i] = parray[i].calcNetForceExertedByY(parray);
			}

			for(int i = 0; i &lt; parray.length; i++)
			{
				parray[i].update(dt,xForces[i],yForces[i]);
			}

			StdDraw.picture(0,0,&quot;./images/starfield.jpg&quot;);
			for(Planet p : parray)
			{
				p.draw();
			}

			StdDraw.show(10);
			time += dt;
		}

		StdOut.printf(&quot;%d\n&quot;, parray.length);
<A NAME="2"></A>		StdOut.printf(&quot;%.2e\n&quot;, radius);
		for (Planet p : parray) </B></FONT>
		{
<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match132-1.html#2',3,'match132-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>		    StdOut.printf(&quot;%11.4e %11.4e %11.4e %11.4e %11.4e %12s\n&quot;,
		                   p.xxPos, p.yyPos, p.xxVel, p.yyVel, p.mass, p.imgFileName);
		}
	}

	public static double readRadius(String filename)
	{
		In input = new In(filename);
		input.readInt();
		return input.readDouble();
	}

	public static Planet[] readPlanets(String filename)
	{
		In in = new In(filename);
		int numPlanets = in.readInt();
		in.readDouble();

		Planet[] parray = new Planet[numPlanets];

		for(int i = 0; i &lt; parray.length; i++)
		{
			parray[i] = new Planet(in.readDouble(),in.readDouble(),
			in.readDouble(),in.readDouble(),in.readDouble(),in.readString());
		}

		return parray;
	}
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>Planet.java</CENTER></H3><HR>
<PRE>
<A NAME="3"></A>import java.lang.Math;

<FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match132-1.html#3',3,'match132-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>public class Planet
{
	public double xxPos;
	public double yyPos;
	public double xxVel;
	public double yyVel;
	public double mass;
	public String imgFileName;

	public Planet(double xxPos, double yyPos, double xxVel, double yyVel, double mass, String imgFileName)
	{
		this.xxPos = xxPos;
		this.yyPos = yyPos;
		this.xxVel = xxVel;
		this.yyVel = yyVel;
		this.mass = mass;
		this.imgFileName = imgFileName;
	}

	public Planet(Planet p)
	{
		this.xxPos = p.xxPos;
		this.yyPos = p.yyPos;
		this.xxVel = p.xxVel;
		this.yyVel = p.yyVel;
		this.mass = p.mass;
		this.imgFileName = p.imgFileName;
	}

	public double calcDistance(Planet p2)</B></FONT>
	{
		return Math.sqrt((xxPos - p2.xxPos)*(xxPos - p2.xxPos) + (yyPos - p2.yyPos)*(yyPos - p2.yyPos));
	}

	public double calcForceExertedBy(Planet p2)
<A NAME="4"></A>	{
		double r_squared = calcDistance(p2)*calcDistance(p2);
		return (6.67e-11)*mass*p2.mass/r_squared;
<FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match132-1.html#4',3,'match132-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>	}

	public double calcForceExertedByX(Planet p2)
	{
		return calcForceExertedBy(p2)*(p2.xxPos - xxPos)/calcDistance(p2);
	}

	public double calcForceExertedByY(Planet p2)
	{
		return calcForceExertedBy(p2)*(p2.yyPos - yyPos)/calcDistance(p2);
	}

	public double calcNetForceExertedByX(Planet[] parray)
	{
		double xNetForce = 0;

		for(Planet planet : parray)
		{
			if(!this.equals(planet))
			{
				xNetForce += calcForceExertedByX(planet);
			}
		}

		return xNetForce;
	}

	public double calcNetForceExertedByY(Planet[] parray)
	{
		double yNetForce = 0;

		for(Planet planet : parray)
		{
			if(!this.equals(planet))
			{
				yNetForce += calcForceExertedByY(planet);
			}
		}

		return yNetForce;
	}

	public void update (double dt, double fX, double fY)
	{
		double xAccel = fX/mass;
		double yAccel = fY/mass;
		xxVel = xxVel + dt*xAccel;
		yyVel = yyVel + dt*yAccel;
		xxPos = xxPos + dt*xxVel;
		yyPos = yyPos + dt*yyVel;
	}

	public void draw()
	{
		StdDraw.picture(xxPos, yyPos, &quot;./images/&quot; + imgFileName);
	}

}</B></FONT>
</PRE>
</BODY>
</HTML>
